<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lista de Contactos - DOM y JavaScript</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <style>
        .list-group-item-action {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .favorite-btn {
            cursor: pointer;
            color: gray;
            font-size: 1.5em;
        }

        .favorite-btn.favorited {
            color: gold;
        }
    </style>
</head>
<body>
    <div class="container my-1 my-sm-2 my-md-4 my-lg-5">
        <h1>Lista de Contactos</h1>
        <div class="card">
            <div class="card-body">
                <h2>Contactos</h2>
                <div class="d-flex justify-content-between mb-3">
                    <div class="btn-group" role="group">
                        <button id="sort-nombre" class="btn btn-outline-primary">Ordenar por Nombre</button>
                        <button id="sort-apellido" class="btn btn-outline-primary">Ordenar por Apellido</button>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="show-favorites">
                        <label class="form-check-label" for="show-favorites">Ver solo Favoritos</label>
                    </div>
                </div>
                <ul id="lista-contactos" class="list-group"></ul>
                <hr class="hr">
                <h2>Nuevo Contacto</h2>
                <form id="form-contacto">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" name="nombre" id="input-nombre" placeholder="Nombre"
                            aria-label="Nombre" required>
                        <input type="text" class="form-control" name="apellido" id="input-apellido" placeholder="Apellido"
                            aria-label="Apellido" required>
                        <input type="tel" class="form-control" name="telefono" id="input-telefono" placeholder="Teléfono"
                            aria-label="Teléfono" required>
                    </div>
                    <button class="btn btn-primary" type="submit">Agregar Contacto</button>
                </form>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous">
    </script>
    <script type="text/javascript">
        let contactos = [{
            nombre: 'Juan',
            apellido: 'Perez',
            telefono: '123-456-7890',
            favorito: false
        }, {
            nombre: 'Maria',
            apellido: 'Gomez',
            telefono: '987-654-3210',
            favorito: true
        }];

        let ordenActual = 'nombre';
        let verFavoritos = false;

        function agregarContacto(nombre, apellido, telefono) {
            const nuevoContacto = {
                nombre,
                apellido,
                telefono,
                favorito: false
            };
            contactos.push(nuevoContacto);
            ordenarContactos(ordenActual);
            mostrarListado();
        }

        function ordenarContactos(criterio) {
            contactos.sort((a, b) => {
                const valorA = a[criterio].toLowerCase();
                const valorB = b[criterio].toLowerCase();
                if (valorA < valorB) {
                    return -1;
                }
                if (valorA > valorB) {
                    return 1;
                }
                return 0;
            });
            ordenActual = criterio;
        }

        function mostrarListado() {
            const lista = document.getElementById('lista-contactos');
            lista.innerHTML = '';
           
            const contactosAMostrar = verFavoritos ? contactos.filter(c => c.favorito) : contactos;

            contactosAMostrar.forEach((contacto, index) => {
                const li = document.createElement('li');
                li.className = 'list-group-item list-group-item-action';
                li.innerHTML = `
                    <div class="contact-info">
                        <strong>${contacto.nombre} ${contacto.apellido}</strong> - ${contacto.telefono}
                    </div>
                    <span class="favorite-btn ${contacto.favorito ? 'favorited' : ''}" data-index="${index}">★</span>
                `;
                lista.appendChild(li);
            });
        }

        function handlerFormulario(e) {
            e.preventDefault();
            const inputNombre = e.target.querySelector('#input-nombre');
            const inputApellido = e.target.querySelector('#input-apellido');
            const inputTelefono = e.target.querySelector('#input-telefono');
            const nombre = inputNombre.value;
            const apellido = inputApellido.value;
            const telefono = inputTelefono.value;
           
            agregarContacto(nombre, apellido, telefono);
           
            inputNombre.value = "";
            inputApellido.value = "";
            inputTelefono.value = "";
        }

        function handlerMarcarFavorito(e) {
            const estrella = e.target.closest('.favorite-btn');
            if (estrella) {
                const index = estrella.dataset.index;
                const contacto = contactos[index];
                contacto.favorito = !contacto.favorito;
                mostrarListado();
            }
        }

        function handlerOrdenar(e) {
            if (e.target.id === 'sort-nombre') {
                ordenarContactos('nombre');
            } else if (e.target.id === 'sort-apellido') {
                ordenarContactos('apellido');
            }
            mostrarListado();
        }

        function handlerFiltrarFavoritos() {
            verFavoritos = !verFavoritos;
            mostrarListado();
        }

        document.getElementById('form-contacto').addEventListener('submit', handlerFormulario);
        document.getElementById('lista-contactos').addEventListener('click', handlerMarcarFavorito);
        document.getElementById('sort-nombre').addEventListener('click', handlerOrdenar);
        document.getElementById('sort-apellido').addEventListener('click', handlerOrdenar);
        document.getElementById('show-favorites').addEventListener('change', handlerFiltrarFavoritos);

        // Carga inicial
        ordenarContactos('nombre');
        mostrarListado();
    </script>
</body>
</html>